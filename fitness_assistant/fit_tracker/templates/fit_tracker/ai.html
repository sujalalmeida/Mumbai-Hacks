<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Fitness Assistant</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.0/css/bootstrap.min.css" rel="stylesheet">
    <style>
        :root {
            --primary-color: #6366f1;
            --primary-hover: #4f46e5;
            --secondary-color: #3b82f6;
            --accent-color: #f97316;
            --text-dark: #1e293b;
            --text-light: #64748b;
            --bg-light: #f8fafc;
            --bg-dark: #0f172a;
            --card-bg: #ffffff;
            --border-radius: 16px;
        }

        body {
            font-family: 'Inter', sans-serif;
            background-color: var(--bg-light);
            color: var(--text-dark);
        }

        .modal-content {
            border-radius: var(--border-radius);
            border: none;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
            background-color: var(--card-bg);
        }

        .modal-header {
            background: linear-gradient(to right, var(--primary-color), var(--secondary-color));
            color: white;
            border-radius: var(--border-radius) var(--border-radius) 0 0;
            border-bottom: none;
            padding: 1.25rem 1.5rem;
        }

        .modal-title {
            font-weight: 600;
            margin-bottom: 0;
            font-size: 1.3rem;
        }

        .btn-close {
            color: white;
            opacity: 0.8;
            filter: brightness(5);
        }

        .btn-close:hover {
            opacity: 1;
        }

        #chat-container {
            height: 400px;
            overflow-y: auto;
            padding: 1rem;
            display: flex;
            flex-direction: column;
            gap: 1rem;
            background-color: rgba(99, 102, 241, 0.05);
            border-radius: 12px;
        }

        .ai-message-container, .user-message-container {
            display: flex;
            margin-bottom: 1rem;
            max-width: 80%;
        }

        .ai-message-container {
            align-self: flex-start;
        }

        .user-message-container {
            align-self: flex-end;
            justify-content: flex-end;
        }

        .ai-avatar {
            width: 36px;
            height: 36px;
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            margin-right: 10px;
            flex-shrink: 0;
        }

        .ai-message {
            background-color: white;
            padding: 12px 16px;
            border-radius: 18px 18px 18px 4px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
            color: var(--text-dark);
            position: relative;
            border-left: 3px solid var(--primary-color);
        }

        .user-message {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
            padding: 12px 16px;
            border-radius: 18px 18px 4px 18px;
            box-shadow: 0 2px 10px rgba(99, 102, 241, 0.2);
            max-width: 100%;
        }

        .chat-input-container {
            padding: 0.75rem 0;
        }

        #user-input {
            border-radius: 30px;
            padding: 0.75rem 1.25rem;
            border: 1px solid #e2e8f0;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
            transition: all 0.3s ease;
        }

        #user-input:focus {
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.25);
            outline: none;
        }

        #chat-form button {
            border-radius: 50%;
            width: 48px;
            height: 48px;
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            border: none;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
            box-shadow: 0 3px 10px rgba(99, 102, 241, 0.3);
        }

        #chat-form button:hover {
            background: linear-gradient(135deg, var(--primary-hover), var(--primary-color));
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(99, 102, 241, 0.4);
        }

        .typing-indicator {
            display: flex;
            align-items: center;
            padding: 0.5rem 1rem;
        }

        .typing-dot {
            width: 8px;
            height: 8px;
            background-color: var(--primary-color);
            border-radius: 50%;
            margin: 0 2px;
            animation: typing-animation 1.5s infinite ease-in-out;
        }

        .typing-dot:nth-child(1) { animation-delay: 0s; }
        .typing-dot:nth-child(2) { animation-delay: 0.2s; }
        .typing-dot:nth-child(3) { animation-delay: 0.4s; }

        @keyframes typing-animation {
            0%, 60%, 100% { transform: translateY(0); }
            30% { transform: translateY(-6px); }
        }

        .formatted-content p:last-child {
            margin-bottom: 0;
        }

        /* Quick action buttons */
        .quick-actions {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
            margin-top: 0.75rem;
        }

        .action-button {
            background-color: rgba(99, 102, 241, 0.1);
            color: var(--primary-color);
            border: 1px solid rgba(99, 102, 241, 0.2);
            border-radius: 20px;
            padding: 0.4rem 0.8rem;
            font-size: 0.85rem;
            transition: all 0.2s ease;
            cursor: pointer;
        }

        .action-button:hover {
            background-color: var(--primary-color);
            color: white;
        }

        /* Add a pulsing effect to the initial message */
        @keyframes pulse {
            0% { box-shadow: 0 0 0 0 rgba(99, 102, 241, 0.4); }
            70% { box-shadow: 0 0 0 10px rgba(99, 102, 241, 0); }
            100% { box-shadow: 0 0 0 0 rgba(99, 102, 241, 0); }
        }

        #ai-suggestion {
            animation: pulse 2s infinite;
        }
        
        /* Make the modal non-dismissible by default */
        .modal-static {
            transform: none !important;
        }
    </style>
</head>
<body>
    <!-- AI Assistant Modal -->
    <div class="modal fade" id="aiAssistantModal" tabindex="-1" aria-labelledby="aiAssistantModalLabel" aria-hidden="true" data-bs-backdrop="static">
        <div class="modal-dialog modal-dialog-centered modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h3 class="modal-title" id="aiAssistantModalLabel"><i class="fas fa-robot me-2"></i> Fitness Assistant</h3>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <!-- AI Chat Container -->
                    <div id="chat-container" class="expanded-chat">
                        <!-- AI Suggestion Message -->
                        <div class="ai-message-container">
                            <div class="ai-avatar">
                                <i class="fas fa-robot"></i>
                            </div>
                            <div class="ai-message" id="ai-suggestion">
                                <div class="formatted-content">Welcome to your fitness dashboard! I'll analyze your data and provide personalized suggestions.</div>
                                
                                <div class="quick-actions">
                                    <div class="action-button"><i class="fas fa-chart-line me-1"></i> Progress report</div>
                                    <div class="action-button"><i class="fas fa-dumbbell me-1"></i> Workout plan</div>
                                    <div class="action-button"><i class="fas fa-apple-alt me-1"></i> Nutrition tips</div>
                                </div>
                            </div>
                        </div>
                        <!-- Additional messages will be added here via JavaScript -->
                        <div id="chat-messages"></div>
                    </div>
                    <!-- User Input Area -->
                    <div class="chat-input-container mt-3">
                        <form id="chat-form" class="d-flex">
                            <input type="text" id="user-input" class="form-control me-2" placeholder="Ask me about your fitness data...">
                            <button type="submit" class="btn">
                                <i class="fas fa-paper-plane"></i>
                            </button>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.0/js/bootstrap.bundle.min.js"></script>
    <script>
        // AI Assistant Modal JavaScript
        document.addEventListener('DOMContentLoaded', function() {
            const chatForm = document.getElementById('chat-form');
            const chatContainer = document.getElementById('chat-container');
            const chatMessages = document.getElementById('chat-messages');
            
            // Sample responses for demo purposes
            const aiResponses = [
                "Based on your recent workouts, I suggest increasing your cardio sessions to 3 times per week. Your strength training is on track!",
                "Your weekly calorie expenditure is 15% higher than last month. Great progress!",
                "I notice you haven't logged your water intake today. Staying hydrated is crucial for optimal performance."
            ];
            
            // Automatically open the modal as soon as the page loads
            const aiModal = new bootstrap.Modal(document.getElementById('aiAssistantModal'), {
                backdrop: 'static', // Prevents closing when clicking outside
                keyboard: true      // Allows closing with ESC key
            });
            
            // Open the modal immediately
            aiModal.show();
            
            // Add click handlers for quick action buttons
            document.querySelectorAll('.action-button').forEach(button => {
                button.addEventListener('click', function() {
                    const buttonText = this.textContent.trim();
                    let aiResponse = "";
                    
                    // Add user message based on button clicked
                    const userMessageDiv = document.createElement('div');
                    userMessageDiv.classList.add('user-message-container');
                    userMessageDiv.innerHTML = `<div class="user-message">Show me my ${buttonText.toLowerCase()}</div>`;
                    chatMessages.appendChild(userMessageDiv);
                    
                    // Show typing indicator
                    const typingDiv = document.createElement('div');
                    typingDiv.classList.add('ai-message-container');
                    typingDiv.innerHTML = `
                        <div class="ai-avatar">
                            <i class="fas fa-robot"></i>
                        </div>
                        <div class="typing-indicator">
                            <div class="typing-dot"></div>
                            <div class="typing-dot"></div>
                            <div class="typing-dot"></div>
                        </div>
                    `;
                    chatMessages.appendChild(typingDiv);
                    
                    // Scroll to bottom
                    chatContainer.scrollTop = chatContainer.scrollHeight;
                    
                    // After a delay, show the AI response
                    setTimeout(() => {
                        // Remove typing indicator
                        chatMessages.removeChild(typingDiv);
                        
                        // Determine response based on button
                        if (buttonText.includes("Progress")) {
                            aiResponse = "Your fitness progress is looking great! You've improved your running pace by 10% and increased your weight lifting capacity by 15% over the past month.";
                        } else if (buttonText.includes("Workout")) {
                            aiResponse = "Here's your personalized workout plan for today:<br>• 15 min warm-up cardio<br>• 3 sets of squats (12 reps)<br>• 3 sets of bench press (10 reps)<br>• 2 sets of planks (60 seconds each)<br>• 10 min cool down stretching";
                        } else if (buttonText.includes("Nutrition")) {
                            aiResponse = "Based on your recent activity levels, I recommend increasing your protein intake to support muscle recovery. Aim for 25-30g of protein per meal, and don't forget to stay hydrated!";
                        }
                        
                        // Create AI response element
                        const aiMessageDiv = document.createElement('div');
                        aiMessageDiv.classList.add('ai-message-container');
                        aiMessageDiv.innerHTML = `
                            <div class="ai-avatar">
                                <i class="fas fa-robot"></i>
                            </div>
                            <div class="ai-message">
                                <div class="formatted-content">${aiResponse}</div>
                            </div>
                        `;
                        chatMessages.appendChild(aiMessageDiv);
                        
                        // Scroll to bottom again
                        chatContainer.scrollTop = chatContainer.scrollHeight;
                    }, 1500);
                });
            });
            
            chatForm.addEventListener('submit', function(e) {
                e.preventDefault();
                const userInput = document.getElementById('user-input');
                const messageContent = userInput.value.trim();
                if (messageContent === "") return;
                
                // Append the user message to the chat container
                const userMessageDiv = document.createElement('div');
                userMessageDiv.classList.add('user-message-container');
                userMessageDiv.innerHTML = `<div class="user-message">${messageContent}</div>`;
                chatMessages.appendChild(userMessageDiv);
                
                // Clear the input field
                userInput.value = "";
                
                // Add typing indicator
                const typingDiv = document.createElement('div');
                typingDiv.classList.add('ai-message-container');
                typingDiv.innerHTML = `
                    <div class="ai-avatar">
                        <i class="fas fa-robot"></i>
                    </div>
                    <div class="typing-indicator">
                        <div class="typing-dot"></div>
                        <div class="typing-dot"></div>
                        <div class="typing-dot"></div>
                    </div>
                `;
                chatMessages.appendChild(typingDiv);
                
                // Scroll to see the typing indicator
                chatContainer.scrollTop = chatContainer.scrollHeight;
                
                // After a delay, show a random AI response
                setTimeout(() => {
                    // Remove typing indicator
                    chatMessages.removeChild(typingDiv);
                    
                    // Get random response
                    const randomResponse = aiResponses[Math.floor(Math.random() * aiResponses.length)];
                    
                    // Create AI response element
                    const aiMessageDiv = document.createElement('div');
                    aiMessageDiv.classList.add('ai-message-container');
                    aiMessageDiv.innerHTML = `
                        <div class="ai-avatar">
                            <i class="fas fa-robot"></i>
                        </div>
                        <div class="ai-message">
                            <div class="formatted-content">${randomResponse}</div>
                        </div>
                    `;
                    chatMessages.appendChild(aiMessageDiv);
                    
                    // Scroll to bottom again
                    chatContainer.scrollTop = chatContainer.scrollHeight;
                }, 1500);
            });
        });
    </script>
</body>
</html>